<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>ورود به حساب</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: auto; padding: 20px; direction: rtl; }
    label, input { display: block; margin: 10px 0; width: 100%; }
    iframe { margin-top: 20px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h2>ورود بدون رمز</h2>
  <form id="loginForm">
    <label>اسم:<input type="text" name="fname" required></label>
    <label>تخلص:<input type="text" name="lname" required></label>
    <label>نمبر پاسپورت:<input type="text" name="passport" required></label>
    <label>تاریخ تولد:<input type="text" name="dob" required></label>
    <label>نمبر پروتوکل:<input type="text" name="protocol" required></label>
    <button type="submit">ورود</button>
  </form>

  <div id="result"></div>

  <script>
    const form = document.getElementById('loginForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const data = {
        fname: form.fname.value.trim(),
        lname: form.lname.value.trim(),
        passport: form.passport.value.trim(),
        dob: form.dob.value.trim(),
        protocol: form.protocol.value.trim()
      };

      const response = await fetch("https://script.google.com/macros/s/AKfycbwK9Ug6j7a7a2eiaJ2jpShGl46JgumSr6dW8BGP_FCcRQJrpaVox6Ss-YUye9ertu0/exec", {
        method: "POST",
        body: JSON.stringify(data)
      });

      const result = await response.json();
      if (result.success) {
        document.getElementById('result').innerHTML = `
          <h3>فایل شما:</h3>
          <iframe src="${result.fileUrl.replace('/view?usp=sharing', '/preview')}" width="100%" height="600"></iframe>
        `;
      } else {
        document.getElementById('result').innerHTML = "<p style='color:red;'>اطلاعات شما اشتباه است یا یافت نشد.</p>";
      }
    });
  </script>
</body>
</html>
